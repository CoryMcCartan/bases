<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Exact kernel feature basis — b_ker • bases</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exact kernel feature basis — b_ker"><meta name="description" content="Generates a design matrix that exactly represents a provided kernel, so that
the Gram matrix is equal to the kernel matrix. The feature map is $$
     \phi(x') = K_{x,x}^{-1/2} k_{x,x'},
$$ where \(K_{x,x}\) is the kernel matrix for the data points \(x\) and
\(k_{x, x'}\) is the vector of kernel function evaluations at the data
points and the new value.
While exact, this function is not particularly computationally efficient.
Both fitting and prediction require backsolving the Cholesky decomposition of
the kernel matrix for the original data points."><meta property="og:description" content="Generates a design matrix that exactly represents a provided kernel, so that
the Gram matrix is equal to the kernel matrix. The feature map is $$
     \phi(x') = K_{x,x}^{-1/2} k_{x,x'},
$$ where \(K_{x,x}\) is the kernel matrix for the data points \(x\) and
\(k_{x, x'}\) is the vector of kernel function evaluations at the data
points and the new value.
While exact, this function is not particularly computationally efficient.
Both fitting and prediction require backsolving the Cholesky decomposition of
the kernel matrix for the original data points."><meta property="og:image" content="http://corymccartan.com/bases/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bases</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CoryMcCartan/bases/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Exact kernel feature basis</h1>
      <small class="dont-index">Source: <a href="https://github.com/CoryMcCartan/bases/blob/main/R/b_ker.R" class="external-link"><code>R/b_ker.R</code></a></small>
      <div class="d-none name"><code>b_ker.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates a design matrix that exactly represents a provided kernel, so that
the Gram matrix is equal to the kernel matrix. The feature map is $$
     \phi(x') = K_{x,x}^{-1/2} k_{x,x'},
$$ where \(K_{x,x}\) is the kernel matrix for the data points \(x\) and
\(k_{x, x'}\) is the vector of kernel function evaluations at the data
points and the new value.
While exact, this function is not particularly computationally efficient.
Both fitting and prediction require backsolving the Cholesky decomposition of
the kernel matrix for the original data points.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">b_ker</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="kernels.html">k_rbf</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stdize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale"</span>, <span class="st">"box"</span>, <span class="st">"symbox"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>The variable(s) to build features for. A single data frame or
matrix may be provided as well. Missing values are not allowed.</p></dd>


<dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>A kernel function. If one of the recognized kernel functions
such as <code><a href="kernels.html">k_rbf()</a></code> is provided, then the computations will be exact.
Otherwise, the fast Fourier transform of the provided kernel function is
used to generate the random features. The kernel should be shift-invariant
and decay to zero at positive and negative infinity.</p></dd>


<dt id="arg-stdize">stdize<a class="anchor" aria-label="anchor" href="#arg-stdize"></a></dt>
<dd><p>How to standardize the predictors, if at all. The default
<code>"scale"</code> applies <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale()</a></code> to the input so that the features have mean
zero and unit variance, <code>"box"</code> scales the data along each dimension
to lie in the unit hypercube, and <code>"symbox"</code> scales the data along each
dimension to lie in \([-0.5, 0.5]^d\).</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The (training) data points at which to evaluate the kernel. If
provided, overrides <code>...</code>.</p></dd>


<dt id="arg-shift">shift<a class="anchor" aria-label="anchor" href="#arg-shift"></a></dt>
<dd><p>Vector of shifts, or single shift value, to use. If provided,
overrides those calculated according to <code>stdize</code>.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Vector of scales, or single scale value, to use. If provided,
overrides those calculated according to <code>stdize</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix of kernel features.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># exact kernel ridge regression</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">=</span> <span class="fu"><a href="kernels.html">k_rbf</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="ridge.html">ridge</a></span><span class="op">(</span><span class="va">depth</span> <span class="op">~</span> <span class="fu">b_ker</span><span class="op">(</span><span class="va">lat</span>, <span class="va">long</span>, kernel <span class="op">=</span> <span class="va">k</span><span class="op">)</span>, <span class="va">quakes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, <span class="va">quakes</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9668987</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Forecasting example involving combined kernels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1949</span>, <span class="fl">1961</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1961</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1965</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">=</span> <span class="fu"><a href="kernels.html">k_per</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.2</span>, period <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="kernels.html">k_rbf</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="ridge.html">ridge</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">b_ker</span><span class="op">(</span><span class="va">x</span>, kernel <span class="op">=</span> <span class="va">k</span>, stdize<span class="op">=</span><span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">"Year"</span>, ylab<span class="op">=</span><span class="st">"Passengers (thousands)"</span>,</span></span>
<span class="r-in"><span>    xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1949</span>, <span class="fl">1965</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x_pred</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_pred</span><span class="op">)</span><span class="op">)</span>, lty<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="b_ker-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cory McCartan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

